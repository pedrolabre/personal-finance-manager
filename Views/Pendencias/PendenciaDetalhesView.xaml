<!-- PendenciaDetalhesView.xaml -->
<UserControl x:Class="PersonalFinanceManager.Views.Pendencias.PendenciaDetalhesView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="700" d:DesignWidth="950">
    
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="30">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <!-- CabeÃ§alho com BotÃ£o Voltar -->
            <Grid Grid.Row="0" Margin="0,0,0,20">
                <Button Content="â† Voltar"
                       Command="{Binding VoltarCommand}"
                       Style="{StaticResource SecondaryButtonStyle}"
                       HorizontalAlignment="Left"
                       Width="100"/>
                
                <TextBlock Text="Detalhes da PendÃªncia" 
                          Style="{StaticResource TitleTextBlockStyle}"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"/>
            </Grid>
            
            <!-- InformaÃ§Ãµes Principais -->
            <Border Grid.Row="1" Style="{StaticResource CardStyle}" Margin="0,0,0,20">
                <StackPanel>
                    <!-- Nome e Status -->
                    <Grid Margin="0,0,0,15">
                        <TextBlock Text="{Binding Pendencia.Nome}"
                                  FontSize="24"
                                  FontWeight="Bold"
                                  VerticalAlignment="Center"/>
                        
                        <Border Background="{Binding Pendencia.Status, Converter={StaticResource StatusToColorConverter}}"
                               CornerRadius="5"
                               Padding="12,6"
                               HorizontalAlignment="Right">
                            <TextBlock Text="{Binding Pendencia.Status}"
                                      Foreground="White"
                                      FontWeight="SemiBold"/>
                        </Border>
                    </Grid>
                    
                    <!-- DescriÃ§Ã£o -->
                    <TextBlock Text="{Binding Pendencia.Descricao}"
                              TextWrapping="Wrap"
                              Foreground="{StaticResource TextSecondaryColor}"
                              Margin="0,0,0,20"/>
                    
                    <!-- InformaÃ§Ãµes Gerais -->
                    <UniformGrid Columns="2" Rows="1" Margin="0,0,0,20">
                        <StackPanel Margin="0,0,10,0">
                            <TextBlock Text="Data de Vencimento" 
                                      Style="{StaticResource CardTitleStyle}"/>
                            <TextBlock Text="{Binding Pendencia.DataVencimento, StringFormat=dd/MM/yyyy}"
                                      FontSize="18"
                                      FontWeight="SemiBold"/>
                        </StackPanel>
                        
                        <StackPanel Margin="10,0,0,0">
                            <TextBlock Text="NÃºmero de Parcelas" 
                                      Style="{StaticResource CardTitleStyle}"/>
                            <TextBlock Text="{Binding Pendencia.QuantidadeParcelas}"
                                      FontSize="18"
                                      FontWeight="SemiBold"/>
                        </StackPanel>
                    </UniformGrid>
                    
                    <!-- Valores -->
                    <UniformGrid Columns="3" Rows="1" Margin="0,0,0,20">
                        <StackPanel Margin="0,0,10,0">
                            <TextBlock Text="Valor Total" 
                                      Style="{StaticResource CardTitleStyle}"/>
                            <TextBlock Text="{Binding Pendencia.ValorTotal, StringFormat=C}"
                                      FontSize="28"
                                      FontWeight="Bold"
                                      Foreground="{StaticResource AccentColor}"/>
                        </StackPanel>
                        
                        <StackPanel Margin="5,0">
                            <TextBlock Text="Valor Pago" 
                                      Style="{StaticResource CardTitleStyle}"/>
                            <TextBlock Text="{Binding Pendencia.ValorPago, StringFormat=C}"
                                      FontSize="28"
                                      FontWeight="Bold"
                                      Foreground="{StaticResource SuccessColor}"/>
                        </StackPanel>
                        
                        <StackPanel Margin="10,0,0,0">
                            <TextBlock Text="Valor Restante" 
                                      Style="{StaticResource CardTitleStyle}"/>
                            <TextBlock Text="{Binding Pendencia.ValorRestante, StringFormat=C}"
                                      FontSize="28"
                                      FontWeight="Bold"
                                      Foreground="{StaticResource WarningColor}"/>
                        </StackPanel>
                    </UniformGrid>
                    
                    <!-- Progresso -->
                    <StackPanel>
                        <TextBlock Text="Progresso de Pagamento" 
                                  Style="{StaticResource CardTitleStyle}"
                                  Margin="0,0,0,10"/>
                        <ProgressBar Height="25"
                                    Value="{Binding Pendencia.PercentualPago, Mode=OneWay}"
                                    Maximum="100"
                                    Foreground="{StaticResource SuccessColor}"/>
                        <TextBlock Text="{Binding Pendencia.PercentualPago, Mode=OneWay, StringFormat={}{0:F1}%}"
                                  HorizontalAlignment="Center"
                                  FontWeight="SemiBold"
                                  Margin="0,5,0,0"/>
                    </StackPanel>
                </StackPanel>
            </Border>
            
            <!-- AÃ§Ãµes -->
            <Border Grid.Row="2" Style="{StaticResource CardStyle}" Margin="0,0,0,20">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button Content="âœï¸ Editar"
                           Command="{Binding EditarCommand}"
                           Style="{StaticResource SecondaryButtonStyle}"
                           Width="140"
                           Margin="5"/>
                    
                    <Button Content="ðŸ¤ Criar Acordo"
                           Command="{Binding CriarAcordoCommand}"
                           Style="{StaticResource PrimaryButtonStyle}"
                           Width="140"
                           Margin="5"/>
                    
                    <Button Content="âœ“ Quitar"
                           Command="{Binding QuitarCommand}"
                           Style="{StaticResource SuccessButtonStyle}"
                           Width="140"
                           Margin="5"/>
                    
                    <Button Content="ðŸ—‘ï¸ Excluir"
                           Command="{Binding ExcluirCommand}"
                           Style="{StaticResource DangerButtonStyle}"
                           Width="140"
                           Margin="5"/>
                </StackPanel>
            </Border>
            
            <!-- HistÃ³rico de Acordos -->
            <Border Grid.Row="3" Style="{StaticResource CardStyle}">
                <StackPanel>
                    <TextBlock Text="HistÃ³rico de Acordos" 
                              Style="{StaticResource SubtitleTextBlockStyle}"
                              Margin="0,0,0,15"/>
                    
                    <ItemsControl ItemsSource="{Binding Acordos}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border BorderBrush="{StaticResource BorderLightColor}"
                                       BorderThickness="0,0,0,1"
                                       Padding="0,10"
                                       Margin="0,0,0,10">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <StackPanel Grid.Column="0">
                                            <TextBlock FontWeight="SemiBold">
                                                <Run Text="Acordo de"/>
                                                <Run Text="{Binding DataAcordo, StringFormat=dd/MM/yyyy}"/>
                                            </TextBlock>
                                            
                                            <TextBlock Margin="0,5,0,0">
                                                <Run Text="{Binding NumeroParcelas}"/>
                                                <Run Text="parcelas de"/>
                                                <Run Text="{Binding ValorTotal, StringFormat=C}"/>
                                            </TextBlock>
                                            
                                            <TextBlock Margin="0,5,0,0"
                                                      Foreground="{StaticResource TextSecondaryColor}">
                                                <Run Text="Pagas:"/>
                                                <Run Text="{Binding ParcelasPagas, Mode=OneWay}"/>
                                                <Run Text="/"/>
                                                <Run Text="{Binding NumeroParcelas, Mode=OneWay}"/>
                                            </TextBlock>
                                        </StackPanel>
                                        
                                        <Border Grid.Column="1"
                                               Background="{StaticResource SuccessColor}"
                                               CornerRadius="3"
                                               Padding="8,4"
                                               VerticalAlignment="Center"
                                               Visibility="{Binding Ativo, Converter={StaticResource BoolToVisibilityConverter}}">
                                            <TextBlock Text="ATIVO"
                                                      Foreground="White"
                                                      FontSize="11"
                                                      FontWeight="SemiBold"/>
                                        </Border>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                    
                    <TextBlock Text="Nenhum acordo cadastrado"
                              Foreground="{StaticResource TextSecondaryColor}"
                              HorizontalAlignment="Center"
                              Margin="0,20,0,0"
                              Visibility="{Binding HasAcordos, Converter={StaticResource InverseBoolToVisibilityConverter}}"/>
                </StackPanel>
            </Border>
            
            <!-- Loading Overlay -->
            <Border Grid.Row="0" Grid.RowSpan="4"
                   Background="#80000000"
                   Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}">
                <TextBlock Text="Carregando..."
                          Foreground="White"
                          FontSize="20"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"/>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>
